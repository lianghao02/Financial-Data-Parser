# 未來擴充計畫與技術維護指南

這份文件旨在協助開發者（或未來的您）理解本專案的技術細節，並提供未來功能擴充的方向與建議。

## 🛠️ 技術架構認識

本專案採用純前端架構 (Vanilla JS)，不依賴複雜的打包工具 (如 Webpack/Vite)，優點是**輕量、易於修改、可直接在瀏覽器運行**。

### 核心檔案說明

1. **`index.html`**: 網頁骨架。使用 Tailwind CSS 進行響應式開發，並引入了本地的 `xlsx.full.min.js` 用於處理 Excel。
2. **`script.js`**: 核心邏輯。
    - **`readCSV()`**: 使用 `FileReader` 讀取檔案，目前設定為 `utf-8` 編碼。若遇到舊式銀行檔案出現亂碼，可能需改為 `big5`。
    - **`cleanData()`**: 資料清理的核心。使用正則表達式 (`Regex`) 移除金額格式中的 `+` 和 `.00`。
    - **`applyExcelCellFormatting()`**: 確保所有儲存格均以文字格式寫入，以保留帳號前導零。

---

## 🚀 未來功能擴充建議

如果您希望讓這個工具更強大，可以考慮以下開發方向：

### 1. 資料預覽功能 (Data Preview)

- **現況**：使用者拖入檔案後只能看到檔名。
- **計畫**：在轉換前，先在網頁上顯示前 5 筆資料的表格，讓使用者確認編碼是否正確（有無亂碼）以及格式是否符合預期。

### 2. 自訂欄位對應 (Custom Mapping)

- **現況**：目前是針對所有欄位進行 `+` 和 `.00` 的清理。
- **計畫**：增加設定介面，讓使用者勾選「哪些欄位」需要清理，或是指定「帳號欄位」的名稱，避免誤改到其他數據。

### 3. 支援更多匯出格式

- **現況**：僅支援 `.xlsx`。
- **計畫**：新增 `.json`, `.xml` 或 `.csv` (清洗後的) 匯出選項，方便對接其他系統。

### 4. 離線版 / PWA 支援

- **現況**：依賴 CDN 載入 SheetJS，需連網。
- **計畫**：
  - 下載 `xlsx.full.min.js` 到本地專案資料夾，修改 `index.html` 引用本地路徑，即可完全離線使用。
  - 設定 `manifest.json` 與 Service Worker，將其升級為 PWA (Progressive Web App)，可安裝在桌面或手機上。

### 5. 錯誤處理與提示優化

- **現況**：基本的 `alert` 錯誤提示。
- **計畫**：使用更美觀的 Toast 通知（如 SweetAlert2），並針對特定錯誤（如檔案格式錯誤、欄位缺失）提供更明確的引導。

---

## 🔧 維護與常見問題 (FAQ)

### Q1: 銀行 CSV 格式改版了怎麼辦？

請開啟 `script.js`，找到 `cleanData` 函式。

- 若是**欄位順序**變了：本程式目前是逐格處理，不受順序影響。
- 若是**特殊符號**變了（例如變成 `NT$100`）：請修改正則表達式。

  ```javascript
  // 例如要移除 "NT$"
  val = val.replace('NT$', '');
  ```

### Q2: 匯出的 Excel 帳號前面的 0 不見了？

請檢查 `script.js` 中設定儲存格格式的這段程式碼：

```javascript
ws[cell_address].t = 's'; // 設定為文字 (String)
ws[cell_address].z = '@'; // 設定顯示格式為文字
```

確保這段邏輯有正確執行。

### Q3: 打開網頁發現中文亂碼？

這通常是 CSV 編碼問題。請修改 `script.js` 中的 `readAsText`：

```javascript
// 改為 big5 (適用於舊式繁體中文系統)
reader.readAsText(file, 'big5');
```

---
*持續優化，讓工具更順手！*
